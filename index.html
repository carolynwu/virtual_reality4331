<html>
<head>
    <title>Example 10.02 - Bump maps</title>
    <script src="js/aframe.min.js"></script>
    <script src="js/sky.js"></script>
    <!--<script src="https://cdn.rawgit.com/donmccurdy/aframe-extras/v1.14.0/dist/aframe-extras.min.js"></script>-->
    <script src="http://cdn.rawgit.com/donmccurdy/aframe-extras/v3.13.1/dist/aframe-extras.min.js"></script>
</head>

<body >
<script>
    AFRAME.registerComponent('sun-position-setter', {
        init: function () {
            var skyEl = this.el;
            var orbitEl = this.el.sceneEl.querySelector('#orbit');

            orbitEl.addEventListener('componentchanged', function changeSun (evt) {
                var sunPosition;
                var phi;
                var theta;

                if (evt.detail.name !== 'rotation') { return; }

                sunPosition = orbitEl.getAttribute('rotation');

                if(sunPosition === null) { return; }

                theta = Math.PI * (- 0.5);
                phi = 2 * Math.PI * (sunPosition.y / 360 - 0.5);
                //Debugging position
                //console.log(Math.cos(phi), Math.sin(phi) * Math.sin(theta))
                skyEl.setAttribute('material', 'sunPosition', {
                    x: Math.cos(phi),
                    y: Math.sin(phi) * Math.sin(theta),
                    z: -1
                });
            });
        }
    });
</script>
<a-scene physics>
    <a-assets>
        <a-asset-item id="dog" src="images/dog_with_bomb/scene.gltf"></a-asset-item>
    </a-assets>
        <!-- Player -->
        <a-entity camera="userHeight: 1.6"
                  universal-controls
                  kinematic-body>

            <a-entity raycaster="far:150;objects:.intersectable" cursor geometry="primitive:ring;radiusOuter:0.015;radiusInner:0.01" material="color:#283644;shader:flat" position="0 0 -0.75"></a-entity>
        </a-entity>






    <a-entity id="sky" geometry="primitive:sphere;radius:200" material="sunPosition:-0.9997454282845177 0.022562770756406943 -1;shader:sky;side:back" sun-position-setter="">
        <!--Position the sun-->
        <a-entity id="orbit" rotation="0 1.3301069669709749 0">
            <a-animation attribute="rotation" from="0 0 0" to="0 270 0" dur="100000" repeat="100"></a-animation>
        </a-entity>
    </a-entity>


    <!--pillars -->
    <<a-cylinder position="7.846 1.6 19.925" raidus="0.5" height="3.2" color="#804040"  geometry="radius:0.1;height:1.2"></a-cylinder>
    <a-cylinder position="4.244 1.6 19.93" radius="0.5" height="3.2" color="#804040"  geometry="radius:0.1;height:1.2"></a-cylinder>

    <!-- banner -->
    <a-box color="#004040" position="6.061 2.052 19.536" rotation="0 90 0" depth="2.5" height="1" width="2"  geometry="depth:3.5;height:0.5;width:0.5"  ></a-box>
    <a-text value="Welcome Back!" position="4.437 2.121 19.873" width="10" color="#ffffff" text="">  </a-text>






    <!--plane-->
    <a-entity static-body="" geometry="depth:300;width:300;height:0.1" position="2.774 -1.035 7.582" material="shader:flat;side:double;src:images/ground.jpeg"></a-entity>



    <!-- Ceiling -->



    <!--wall-->
    <a-entity static-body="" geometry="height:3.2;depth:0.2;width:12" position="0 1.6 0" material="repeat:12 2;roughness:1;src:images/wall.jpg"></a-entity>



    <a-entity static-body="" geometry="width:2.8;height:3.2;depth:0.2" position="0 1.6 2.4" material="repeat:12 2;roughness:1;src:images/wall.jpg"></a-entity>
    <a-entity static-body="" geometry="width:2.8;height:3.2;depth:0.2" position="-4.6 1.6 2.4" material="repeat:12 2;roughness:1;src:images/wall.jpg"></a-entity>
    <a-entity static-body="" geometry="width:2.8;height:3.2;depth:0.2" position="0 1.6 3.6" material="repeat:12 2;roughness:1;src:images/wall.jpg"></a-entity>
    <a-entity static-body="" geometry="height:0.6;width:0.8;depth:0.2" position="-1.8 2.9 3.6" material="repeat:12 2;roughness:1;src:images/wall.jpg"></a-entity>
    <a-entity static-body="" geometry="depth:0.2;height:0.6;width:0.8" position="-1.8 2.9 2.4" material="repeat:12 2;roughness:1;src:images/wall.jpg"></a-entity>
    <a-entity static-body="" geometry="depth:0.2;height:0.6;width:0.8" position="-2.8 2.9 2.4" material="repeat:12 2;roughness:1;src:images/wall.jpg"></a-entity>
    <a-entity static-body="" geometry="width:1.1;height:0.6;depth:0.2" position="-2.3 2.9 3" material="repeat:12 2;roughness:1;src:images/wall.jpg" rotation="0 90 0"></a-entity>
    <a-entity static-body="" geometry="height:3.2;depth:0.2;width:12" position="0 1.6 7.2" material="repeat:12 2;roughness:1;src:images/wall.jpg"></a-entity>
    <a-entity static-body="" geometry="height:3.2;width:7;depth:0.2" position="-5.9 1.6 3.6" material="repeat:12 2;roughness:1;src:images/wall.jpg" rotation="0 90 0"></a-entity>
    <a-entity static-body="" geometry="height:3.2;width:2.4;depth:0.2" position="1.4 1.6 1.3" material="repeat:12 2;roughness:1;src:images/wall.jpg" rotation="0 90 0"></a-entity>
    <a-entity static-body="" geometry="depth:0.2;height:3.2;width:2.4" position="-2.3 1.6 1.3" material="repeat:12 2;roughness:1;src:images/wall.jpg" rotation="0 90 0"></a-entity>
    <a-entity static-body="" geometry="height:3.2;width:3.6;depth:0.2" position="1.4 1.6 5.3" material="repeat:12 2;roughness:1;src:images/wall.jpg" rotation="0 90 0"></a-entity>
    <a-entity static-body="" geometry="depth:0.2;height:3.2;width:3.6" position="-2.3 1.6 5.3" material="repeat:12 2;roughness:1;src:images/wall.jpg" rotation="0 90 0"></a-entity>
    <a-entity static-body="" geometry="height:3.2;width:7;depth:0.2" position="5.9 1.6 3.6" material="repeat:12 2;roughness:1;src:images/wall.jpg" rotation="0 90 0"></a-entity>



    <!--light-->
    <a-light type="spot" color="#F5F5F5" position="-11.633 -1.319 69.044" light="type:ambient"></a-light>

    <!-- floor-->
    <a-entity position="0 -0.1 3.6" rotation="90 90 90" geometry="height:7.4;width:12;depth:0.2" mixin="null" material="repeat:12 2;roughness:1;src:images/floor.jpg"></a-entity>


    <!--sofa-->
    <a-entity position="5.7 0.375 5.2" rotation="0 90 0" geometry="height:0.75;depth:0.2;width:2.4" material="repeat:12 2;roughness:1;src:images/sofa1.jpeg"></a-entity>
    <a-entity position="5.2 0.25 5.2" rotation="0 90 0" geometry="width:2;height:0.45;depth:0.8" material="repeat:12 2;roughness:1;src:images/sofa1.jpeg"></a-entity>
    <a-entity position="5.2 0.375 4.1" rotation="0 90 0" geometry="width:0.2;height:0.75;depth:0.8" material="repeat:12 2;roughness:1;src:images/sofa.jpg"></a-entity>
    <a-entity position="5.2 0.375 6.3" rotation="0 90 0" geometry="depth:0.8;height:0.75;width:0.2" material="repeat:12 2;roughness:1;src:images/sofa.jpg"></a-entity>

    <!--coffee table -->
    <a-obj-model src="coffee_table/100747_b.obj" mtl="coffee_table/100747_b.mtl" position="3.16 0.746 5.304" rotation="0 90 0" geometry="depth:0.6;width:0.8;height:0.45" scale="0.08 0.08 0.08"></a-obj-model>

    <a-entity position="0 3.3 3.6" rotation="90 90 90" visible="false" geometry="depth:0.2;height:7.4;width:12" mixin="null"></a-entity>

    <a-entity position="4.8 0.75 1.4" geometry="height:0.02;depth:0.9;width:0.9"></a-entity>

    <!-- dog-->
    <a-entity gltf-model="#dog" position="-8.06 -0.53 11.41" rotation="0 0 0"  scale="0.02 0.02 0.02"></a-entity>
    <a-box material="color:tomato;transparent:true;opacity:0" depth="2" height="2" width="2" sound="src: url(images/dog_sound.wav); on: click" class="intersectable" position="-8.06 -0.53 11.41"></a-box>


    <!--countertops-->
    <a-entity position="2.5 0.4 2.2" geometry="height:0.8;width:2;depth:0.6" material="repeat:12 2;roughness:1;src:images/counters.jpg"></a-entity>
    <a-entity position="2.5 0.4 0.4" geometry="depth:0.6;height:0.8;width:2" material="repeat:12 2;roughness:1;src:images/counters.jpg"></a-entity>
    <a-entity position="2.5 2.8 0.4" geometry="depth:0.6;height:0.8;width:2"></a-entity>

    <!-- TV-->
    <a-entity position="1.55 1.2 5.2" rotation="0 90 0" geometry="depth:0.1;height:0.6;width:1.2" material="repeat:12 2;roughness:1;src:images/tv.jpeg" ></a-entity>

   <!-- TV cabinet-->
    <a-entity position="1.7 0.25 5.2" rotation="0 90 0" geometry="width:1.5;depth:0.4;height:0.45" material="repeat:12 2;roughness:1;src:images/tc.jpg"></a-entity>


    <!-- swimming pool -->
    <a-ocean width="5" depth="15" density="100" position="-10.7 0.066 -13.9" rotation="-90 0 0" scale="1 1 1" visible="true" ocean="width:5;depth:15;density:100"></a-ocean>
    <a-entity static-body="" geometry="height:1.5;width:15;depth:0.2" position="-8.06 0.852 -13.7" material="repeat:12 2;roughness:1;src:images/ceramic_floor.jpg" rotation="0 90 0"></a-entity>

    <a-entity static-body="" geometry="height:1.5;width:15;depth:0.2" position="-13.2 0.813 -13.8" material="repeat:12 2;roughness:1;src:images/ceramic_floor.jpg" rotation="0 90 0"></a-entity>


    <a-entity position="4.4 0.35 1" geometry="radius:0.01;height:0.75;primitive:cylinder"></a-entity>
    <a-entity position="4.4 0.35 1.8" geometry="primitive:cylinder;height:0.75;radius:0.01"></a-entity>
    <a-entity position="5.2 0.35 1.8" geometry="primitive:cylinder;height:0.75;radius:0.01"></a-entity>
    <a-entity position="5.2 0.35 1" geometry="primitive:cylinder;height:0.75;radius:0.01"></a-entity>



</a-scene>

</body>
</html>
